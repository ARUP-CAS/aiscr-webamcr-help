{
  "hash": "af419a4981becb3980dac7274d4c159c",
  "result": {
    "markdown": "# OAI-PMH API\n\nAPI v současné době nabízí službu *AMCR Data Provider*, která poskytuje metadatové záznamy z databáze AMČR, a to pomocí protokolu *OpenArchives Initiative Protocol for Metadata Harvesting* ([OAI-PMH](http://www.openarchives.org/pmh/)).\n\nNaše implementace protokolu OAI-PMH podporuje reprezentaci metadat ve standardech:\n\n- [Dublin Core](http://dublincore.org/) -- poskytuje část datasetu týkající se dokumentů a jejich popisu;\n- ~~[CIDOC-CRM](http://www.cidoc-crm.org/) - nabízí archivovaná, volně přístupná data z AMČR ve formátu RDF v syntaxi odpovídající této ontologii;~~\n- **AMČR XML** -- nativní formát, který umožňuje plné vytěžování databáze při zohlednění přístupových práv.\n\n[Uživatelé](role.qmd) s vyšším oprávněním mohou využít své přihlašovací údaje do AMČR pro přístup k nearchivovaným či jinak chráněným záznamům. \nAktualizace dat probíhá na denní bázi.\n\n## Technické řešení\n\n![OAI-PMH API a služba AMCR Data Provider](figs/api-schema.png){#fig-api width=80% align=\"center\"}\n\nArchitektura API se skládá z 5 komponent: *AMCR Filter*, *RDF Converter*, *Scrub*, *AMCR Pass* a *AMCR Data Provider*.\nVšechny komponenty jsou napsány v jazyce Java. \n~~Řešení používá open-source projekt X3ML Engine pro konverzi XML na RDF.~~\n\n![Schéma celkového řešení API](figs/api-reseni.png){#fig-api-reseni}\n\n![Schéma databáze s dílčími datovými sety](figs/api-sety.png){#fig-api-sety}\n\n### Filtrace\n\n#### Stav a přístupnost záznamu\n\nPřístupnost záznam je ovlivněna jak [procesními stavy](procesy.qmd) daných metadatových záznamů, tak [uživatelskou rolí](role.qmd).\n\n![Schéma přístupnosti záznamů dle uživatelských rolí](figs/api-pristupnost.png){#fig-api-pristupnost}\n\n#### Sety\n\nSelektivní výběr je umožněn pomocí nadefinovaných setů, viz také @fig-api-sety.\n\n\n::: {#tbl-api-sets .cell tbl-cap='Sety'}\n::: {.cell-output-display}\n|setSpec          |setName                                                             |\n|:----------------|:-------------------------------------------------------------------|\n|projekt          |Projekty / Projects                                                 |\n|akce             |Akce / Fieldwork Events                                             |\n|lokalita         |Lokality / Sites                                                    |\n|dok_jednotka     |Dokumentační jednotky / Descriptive Units                           |\n|adb              |Archeologický dokumentační bod / Archaeological Documentation Point |\n|dokument         |Dokumenty / Documents                                               |\n|soubor           |Soubory / Files                                                     |\n|pian             |PIAN / Spatial Units                                                |\n|ext_zdroj        |Externí zdroje / External Sources                                   |\n|let              |Lety / Flights                                                      |\n|samostatny_nalez |Samostatné nálezy / Individual Finds                                |\n:::\n:::\n\n\n#### Datestamps\n\nPro dotazy `ListRecords` a `ListIdentifiers` je umožněno filtrování na základě volitelného argumentu\n`datestamp` (from – od, until – do), kdy `datestamp` je vždy nejmladší z dostupných datumů.\n\n![Specifikace nastavení `datestamp` pro jednotlivé záznamy](figs/api-datestamps.png){#fig-api-datestamps}\n\nAMČR nepodporuje evidenci smazaných záznamů. \nPo smazání záznamu z databáze proto dojde k odstranění záznamu z API bez náhrady ve formě hlavičky smazaného záznamu (`status=\"deleted\"`).\nNěkteré operace se v AMČR se nemusí projevit změnou `datestamp` v API. \nDůvodem je způsob logování změn, který se váže pouze na specifické operace (změna [stavu](procesy.qmd) záznamu). \nPři využití API proto doporučujeme data pravidelně obnovovat, nebo umožnit uživateli vynucenou aktualizaci konkrétního záznamu. \nPodpora úplného sledování změn bude implementována v budoucích verzích API po provedení nutných úprav v databázi AMČR\n\n## Příklady využití\n\nAPI najdete na adrese [https://api.aiscr.cz](https://api.aiscr.cz).\n\n[![Poster prezentující API s příklady možných requestů [@pajdla2021]](/figs/api_liseh.png){width=100% fig-align=\"center\" #fig-api-poster}](https://gams.uni-graz.at/o:liseh.8112/PDF_STREAM)\n\n### Přihlášení\n\nPokud chcete pro stahování dat používat svůj účet AMČR, je nutné přihlášení pomocí Basic access authentication. \nProtokol https zajišťuje bezpečnou komunikaci.\nZpůsob přihlášení se liší v každém nástroji, který je pro stahování dat používán. \nNíže jsou detailněji popsány způsoby přihlášení pro *cURL* a *Postman*.\n\n#### cURL\n\ncURL je nástroj skládající se ze softwarové knihovny (libcurl) a z nástroje příkazového řádku (curl) sloužících ke stahování souborů přes počítačovou síť. \nNástroj je dostupný pro různé operační systémy Linux, macOS a Windows. \nSvé uživatelské jméno a heslo je možné zadat pomocí přepínače -u.\n\n```bash\ncurl -u username:password <GET request>\n```\n\nPřihlašovací údaje je nutné posílat v každém requestu.\n\n#### Postman\n\nPostman je multiplatformní aplikace pro vývojáře sloužící k návrhu a interakci s HTTP API. \nUživatelské jméno a heslo lze zadávat na kartě *Autorizace*. \nV rozevírací nabídce *TYPE* zvolte možnost *Basic Auth* a stiskněte tlačítko *Odeslat*.\nPřihlašovací údaje jsou poté posílány automaticky v každém requestu.\n\n### Verbs\n\nDotazování v protokolu OAI-PMH je možné pomocí tzv. sloves (verbs). \nVýznam jednotlivých sloves s příkladem užití jsou popsány v následujících kapitolách. \nPodrobná specifikace protokolu OAI-PMH je k dispozici [zde](http://www.openarchives.org/OAI/openarchivesprotocol.html).\n\n#### Identify\n\nSloveso `Identify` se používá k získání informací o úložišti.\n\nDotaz: [https://api.aiscr.cz/dapro/oai?verb=Identify](https://api.aiscr.cz/dapro/oai?verb=Identify)\n\n#### ListMetadataFormats\n\nSloveso `ListMetadataFormats` se používá k načtení formátů metadat dostupných z úložiště.\n\nDotaz: [https://api.aiscr.cz/dapro/oai?verb=ListMetadataFormats](https://api.aiscr.cz/dapro/oai?verb=ListMetadataFormats)\n\nOdpověď:\n\n```xml\n<OAI-PMH xsi:schemaLocation=\"http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd\">\n  <responseDate>2023-07-10T14:10:00Z</responseDate>\n  <request verb=\"ListMetadataFormats\">https://api.aiscr.cz/dapro/oai</request>\n  <ListMetadataFormats>\n    <metadataFormat>\n      <metadataPrefix>oai_dc</metadataPrefix>\n      <schema>http://www.openarchives.org/OAI/2.0/oai_dc.xsd</schema>\n      <metadataNamespace>http://www.openarchives.org/OAI/2.0/oai_dc/</metadataNamespace>\n    </metadataFormat>\n    <metadataFormat>\n      <metadataPrefix>oai_rdf</metadataPrefix>\n      <schema>https://api.aiscr.cz/dapro/media/oai_rdf.xsd</schema>\n      <metadataNamespace>https://api.aiscr.cz/schema/oai_rdf/</metadataNamespace>\n    </metadataFormat>\n     <metadataFormat>\n      <metadataPrefix>oai_amcr</metadataPrefix>\n      <schema>https://api.aiscr.cz/dapro/media/oai_amcr.xsd</schema>\n      <metadataNamespace>https://api.aiscr.cz/schema/oai_amcr/</metadataNamespace>\n    </metadataFormat>\n  </ListMetadataFormats>\n</OAI-PMH>\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}